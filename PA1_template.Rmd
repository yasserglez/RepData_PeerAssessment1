---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This assignment makes use of data from a personal activity monitoring device. 
This device collects data at 5 minute intervals throughout the day. 
The data consists of two months of data from an anonymous individual 
collected during the months of October and November, 2012 and include 
the number of steps taken in 5 minute intervals each day.

## Loading the required packages

The following packages are required to perform the analysis.

```{r load_packages}
library("dplyr", warn.conflicts = FALSE)
library("lubridate")
library("ggplot2")
```

## Loading and preprocessing the data

First, the CSV file is extracated from the ZIP file and the data 
is loaded into a `data.frame` object named `original_data`.

```{r load_data}
zip_file <- "activity.zip"
unzip(zip_file, overwrite = TRUE)
csv_file <- "activity.csv"
original_data <- read.csv(csv_file, header = TRUE)
```

Next, the string values in the `date` column are transformed into 
`POSIXct` objects.

```{r transform_data}
original_data <- mutate(original_data, date = ymd(date))
str(original_data)
```

## What is the mean total number of steps taken per day?

```{r daily_activity}
daily_activity <- original_data %>%
    group_by(date) %>%
    summarize(total_steps = sum(steps, na.rm = TRUE))

mean_steps <- mean(daily_activity$total_steps)
mean_color <- "red"
median_steps <- median(daily_activity$total_steps)
median_color <- "blue"
    
ggplot(daily_activity, aes(x = date, y = total_steps)) +
    geom_bar(stat = "identity") +
    geom_hline(yintercept = mean_steps, colour = mean_color) +
    geom_hline(yintercept = median_steps, colour = median_color) +
    xlab("Date") +
    ylab("Total number of steps")
```

The mean and median total number of steps taken per day are `r mean_steps` 
(`r mean_color` line) and `r median_steps` (`r median_color` line),
respectively.

## What is the average daily activity pattern?

```{r activity_pattern}
activity_pattern <- original_data %>%
    group_by(interval) %>%
    summarize(average_steps = mean(steps, na.rm = TRUE))

i <- which.max(activity_pattern$average_steps)
max_average_steps <- activity_pattern$average_steps[i]
max_interval <- activity_pattern$interval[i]
max_color <- "red"

ggplot(activity_pattern, aes(x = interval, y = average_steps)) +
    geom_line() +
    geom_point(x = max_interval, y = max_average_steps,
               color = max_color, size = 4) +
    xlab("Interval") +
    ylab("Average number of steps")
```

The maximum average number of steps is reached at the 5-minute interval 
`r max_interval` (`r max_color` dot).

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
